# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–±–æ—Ä–∫–µ iOS –ø—Ä–æ–µ–∫—Ç–∞ Remalux

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: ArgumentNullException —Å —à–µ–π–¥–µ—Ä–æ–º
**–°–∏–º–ø—Ç–æ–º:** `ArgumentNullException: Value cannot be null. Parameter name: shader`
**–ü—Ä–∏—á–∏–Ω–∞:** –®–µ–π–¥–µ—Ä `Universal Render Pipeline/Lit` –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ iOS
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∏—Å–∫–∞ —à–µ–π–¥–µ—Ä–æ–≤ —Å —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ú–æ–¥–µ–ª—å ML –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ Placeholder
**–°–∏–º–ø—Ç–æ–º:** `[WallSegmentation] Model Initialized (Placeholder)`
**–ü—Ä–∏—á–∏–Ω–∞:** –ú–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ StreamingAssets
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞—Å—Ç–æ—è—â–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ML –º–æ–¥–µ–ª–∏

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –°–±–æ—Ä–∫–∞ Unity –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å killed
**–°–∏–º–ø—Ç–æ–º:** `Message from debugger: killed`
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –ø–∞–º—è—Ç–∏ –∏–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞
**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ **–î–û–ë–ê–í–õ–ï–ù–û** - —Å–∏—Å—Ç–µ–º–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–∞–º—è—Ç–∏

## üîß –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ–µ–∫—Ç–∞ Unity

1. **File ‚Üí Build Settings**
   - Platform: iOS
   - Architecture: ARM64

2. **Edit ‚Üí Project Settings ‚Üí Player ‚Üí iOS Settings**
   - **Target minimum iOS Version:** 13.0 –∏–ª–∏ –≤—ã—à–µ
   - **Architecture:** ARM64
   - **Graphics APIs:** 
     - ‚úÖ Metal (–ø–µ—Ä–≤—ã–π –≤ —Å–ø–∏—Å–∫–µ)
     - ‚ùå –£–±—Ä–∞—Ç—å OpenGLES –µ—Å–ª–∏ –µ—Å—Ç—å
   - **Scripting Backend:** IL2CPP
   - **Api Compatibility Level:** .NET Standard 2.1

3. **Edit ‚Üí Project Settings ‚Üí XR Plug-in Management**
   - ‚úÖ ARKit Provider (–¥–ª—è iOS)

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã —á–µ—Ä–µ–∑ Package Manager:**
- AR Foundation (4.2+ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- ARKit XR Plugin
- Unity Sentis (–¥–ª—è ML)
- Universal Render Pipeline

## üõ†Ô∏è –ü—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∫–∏

### –®–∞–≥ 1: –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
1. –û—Ç–∫—Ä—ã—Ç—å —Å—Ü–µ–Ω—É `Assets/Scenes/AR_WallPainting.unity`
2. –°–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç–æ–π GameObject —Å –∏–º–µ–Ω–µ–º "iOS Diagnostics"
3. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `iOSDiagnostics`
4. –í–∫–ª—é—á–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
   - ‚úÖ Run On Start
   - Diagnostic Interval: 10 —Å–µ–∫—É–Ω–¥

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å StreamingAssets
1. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ñ–∞–π–ª `Assets/StreamingAssets/segformer-model.sentis` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (14MB)
2. –ï—Å–ª–∏ –Ω–µ—Ç - —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏

### –®–∞–≥ 3: Build & Run
1. **File ‚Üí Build Settings**
2. –í—ã–±—Ä–∞—Ç—å —Å—Ü–µ–Ω—É `AR_WallPainting`
3. –ù–∞–∂–∞—Ç—å **Build And Run**
4. –í—ã–±—Ä–∞—Ç—å –ø–∞–ø–∫—É –¥–ª—è Xcode –ø—Ä–æ–µ–∫—Ç–∞
5. –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏ Unity

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Xcode
1. –û—Ç–∫—Ä—ã—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–π `.xcodeproj` —Ñ–∞–π–ª
2. **Signing & Capabilities:**
   - –î–æ–±–∞–≤–∏—Ç—å Team
   - –í–∫–ª—é—á–∏—Ç—å Automatic Signing
3. **Info.plist –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:**
   ```xml
   <key>NSCameraUsageDescription</key>
   <string>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–∞–º–µ—Ä—É –¥–ª—è AR —Ñ—É–Ω–∫—Ü–∏–π</string>
   ```
4. **Build Settings:**
   - Deployment Target: iOS 13.0+
   - Architecture: arm64

### –®–∞–≥ 5: –ó–∞–ø—É—Å–∫ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å iPhone/iPad —Å iOS 13+
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–∑ Xcode
3. **–°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏:**
   - –û—Ç–∫—Ä–æ–µ—Ç—Å—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ `=== ü©∫ –ó–ê–ü–£–°–ö iOS –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò ===`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∞–π–¥–µ–Ω—ã ‚úÖ
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ ML –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

## ü©∫ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–ø—É—Å–∫–µ:
```
=== ü©∫ –ó–ê–ü–£–°–ö iOS –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò ===
üì± –ü–†–û–í–ï–†–ö–ê –ü–õ–ê–¢–§–û–†–ú–´:
  ‚Ä¢ –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: IPhonePlayer
  ‚Ä¢ iOS —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: True
üé® –ü–†–û–í–ï–†–ö–ê –®–ï–ô–î–ï–†–û–í:
  ‚úÖ Custom/WallPaint: –ù–∞–π–¥–µ–Ω
ü§ñ –ü–†–û–í–ï–†–ö–ê ML –ú–û–î–ï–õ–ï–ô:
  ‚úÖ segformer-model.sentis: –ù–∞–π–¥–µ–Ω, —Ä–∞–∑–º–µ—Ä 14MB
üì° –ü–†–û–í–ï–†–ö–ê AR –°–ò–°–¢–ï–ú–´:
  ‚úÖ ARSession: –ù–∞–π–¥–µ–Ω
  ‚úÖ ARCameraManager: –ù–∞–π–¥–µ–Ω
üß© –ü–†–û–í–ï–†–ö–ê –ö–û–ú–ü–û–ù–ï–ù–¢–û–í –°–¶–ï–ù–´:
  ‚úÖ WallSegmentation –Ω–∞–π–¥–µ–Ω
    ‚Ä¢ –ú–æ–¥–µ–ª—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞: True
[WallSegmentation] üöÄ –ù–∞—á–∏–Ω–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é ML –º–æ–¥–µ–ª–∏...
[WallSegmentation] ‚úÖ ML –º–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞!
```

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è:

#### ‚ùå –®–µ–π–¥–µ—Ä Custom/WallPaint –Ω–µ –Ω–∞–π–¥–µ–Ω
**–†–µ—à–µ–Ω–∏–µ:** –í–∫–ª—é—á–µ–Ω —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `Universal Render Pipeline/Unlit`

#### ‚ùå segformer-model.sentis –Ω–µ –Ω–∞–π–¥–µ–Ω
**–†–µ—à–µ–Ω–∏–µ:** 
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ StreamingAssets (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å ~14MB)
2. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç —Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º StreamingAssets

#### ‚ùå ML –º–æ–¥–µ–ª—å –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:**
- `[WallSegmentation] ‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏: ...`
- –í–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ CPU backend (selectedBackend = 0)

#### ‚ùå AR Session –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã –≤ Settings iOS
2. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç ARKit

## üéØ –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### –ü—Ä–∏–∑–Ω–∞–∫–∏ —É—Å–ø–µ—à–Ω–æ–π —Ä–∞–±–æ—Ç—ã:
1. ‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
2. ‚úÖ AR –∫–∞–º–µ—Ä–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å
3. ‚úÖ ML –º–æ–¥–µ–ª—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
4. ‚úÖ –û–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ø–ª–æ—Å–∫–æ—Å—Ç–∏
5. ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ–∫—Ä–∞—Å–∫–∞ —Å—Ç–µ–Ω

### –ö–æ–º–∞–Ω–¥—ã Context Menu –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- –í `iOSDiagnostics`: "–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É", "–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞"
- –í `WallSegmentation`: "Test Segmentation", "Validate Performance"

## üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è iOS:
1. **WallSegmentation:**
   - Target Processing Time: 50ms
   - Max Segmentation FPS: 15
   - Adaptive Resolution: ‚úÖ Enabled
   - Preferred Backend: CPU (–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ)

2. **Quality Settings:**
   - Texture Quality: High
   - Anti Aliasing: Disabled or 2x MSAA
   - Realtime Reflection Probes: Disabled

3. **Player Settings:**
   - Scripting Define Symbols: –î–æ–±–∞–≤–∏—Ç—å `SENTIS_DEBUG` –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

## ‚ö° –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### –í Xcode –∫–æ–Ω—Å–æ–ª–∏ –∏—Å–∫–∞—Ç—å:
- `ArgumentNullException` - –ø—Ä–æ–±–ª–µ–º—ã —Å –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏
- `[WallSegmentation] ‚ùå` - –ø—Ä–æ–±–ª–µ–º—ã —Å ML
- `=== ü©∫` - –≤—ã–≤–æ–¥ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ ML –º–æ–¥–µ–ª–∏:
```csharp
// –í Unity Console –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
var ws = FindObjectOfType<WallSegmentation>();
ws.SetFixedResolution(320, 320); // –£–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
```

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–ª–Ω—ã–π –ª–æ–≥ –∏–∑ Xcode Console –∏ –ø—Ä–∏–ª–æ–∂–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥ `iOSDiagnostics`. 