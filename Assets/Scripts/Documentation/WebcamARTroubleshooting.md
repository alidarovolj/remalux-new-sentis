# Руководство по устранению проблем с отображением веб-камеры

## Проблема: Веб-камера не отображается в UI

Если веб-камера инициализируется успешно (о чем свидетельствуют логи), но изображение не отображается в UI, проверьте следующие моменты:

### 1. Проверьте компоненты UI

В первую очередь убедитесь, что для отображения веб-камеры используется компонент `RawImage`, а не обычный `Image`:

1. Выберите объект `WebcamDisplayPanel` в иерархии
2. Проверьте, что на нем или его дочерних объектах есть компонент `RawImage`
3. Компонент `RawImage` должен иметь текстуру (Texture), привязанную к нему

### 2. Ручная настройка отображения

Если автоматическое создание UI не сработало, вы можете настроить отображение вручную:

1. Создайте в Canvas новый UI -> Raw Image
2. Добавьте к нему компонент WebcamDisplaySetup
3. Убедитесь, что настройка autoSetupOnAwake = true
4. Запустите проект

### 3. Проверьте скрипт WebcamDisplay

Если UI создаётся корректно, но изображение не отображается, проверьте:

1. Открыто ли устройство веб-камеры (проверьте логи на наличие "Веб-камера успешно запущена")
2. Правильно ли указана переменная displayImage в скрипте WebcamDisplay
3. Имеется ли доступ к камере (возможно, браузер или другие приложения блокируют доступ)

### 4. Обновите UI при запуске проекта

Если проблема сохраняется:

1. Добавьте в сцену пустой GameObject
2. Добавьте к нему этот скрипт для принудительного обновления камеры:

```csharp
using UnityEngine;

public class WebcamDebugHelper : MonoBehaviour
{
    [SerializeField] private UnityEngine.UI.RawImage targetImage;
    
    // Запустится через 1 секунду после старта
    private void Start()
    {
        Invoke("RefreshCamera", 1.0f);
    }
    
    private void RefreshCamera()
    {
        WebcamDisplay display = FindObjectOfType<WebcamDisplay>();
        if (display != null)
        {
            Debug.Log("Принудительная переинициализация камеры");
            display.StopWebcam();
            display.InitializeWebcam();
        }
        
        if (targetImage != null && targetImage.texture == null)
        {
            Debug.LogWarning("Target RawImage не имеет текстуры!");
            WebCamTexture webcamTexture = new WebCamTexture();
            webcamTexture.Play();
            targetImage.texture = webcamTexture;
        }
    }
}
```

### 5. Замените WebcamDisplay на WebcamDisplaySetup

Если предыдущие шаги не помогли, попробуйте использовать компонент WebcamDisplaySetup вместо WebcamDisplay:

1. Удалите компонент WebcamDisplay с объекта
2. Добавьте компонент WebcamDisplaySetup
3. Настройте ссылку на RawImage в инспекторе
4. Запустите проект

## Проблема: Ошибки AR подсистем

Ошибки типа "No active UnityEngine.XR.ARSubsystems.XRSessionSubsystem is available" при использовании режима веб-камеры являются ожидаемыми. Это связано с тем, что:

1. AR компоненты пытаются инициализироваться, но не находят активных AR-подсистем
2. Наш код WebcamSegmentationSync перехватывает эту ситуацию и активирует режим использования веб-камеры
3. Это нормальная работа в режиме отладки на компьютере

## Проблема: Низкая производительность или зависания

Если при использовании веб-камеры наблюдается низкая производительность:

1. Уменьшите разрешение веб-камеры (попробуйте 320x240 вместо 640x480)
2. Проверьте, не используются ли одновременно несколько экземпляров WebCamTexture
3. Убедитесь, что модель сегментации не слишком требовательна к ресурсам 